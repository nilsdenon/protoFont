<html>

<head>
    <link rel="stylesheet" href="<%=htmlWebpackPlugin.files.chunks.main.css %>">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">
</head>

<body>
    <div class="fontblock">
        <section class="fontblock__body col-8">
            <div class="fontblock__headline">
                <div class="font-primary">
                    <!---<textarea id="primary-font" class="custom-textarea" name="" onchange="autoHeight();" placeholder="Lorem ipsum dolor sit amet" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">Lorem ipsum dolor sit amet</textarea>-->
                    <div id="primary-font" class='font font-primary fake-textarea'>
                            Lorem ipsum dolor sit amet
                    </div>
                </div>
                <span class="hud hud--fontdetails hidden">
                    <dl>
                        <dt>Font Name</dt>
                        <dd>Font Size</dd>
                        <dd>Letter-Spacing</dd>
                        <dd>Line-Height</dd>
                    </dl>
                </span>
            </div>
            <div class="fontblock__bodytext">
                <div class="font-secondary"></div>
                <span class="hud hud--fontdetails hidden">
                    <dl>
                        <dt>Font Name</dt>
                        <dd>Font Size</dd>
                        <dd>Letter-Spacing</dd>
                        <dd>Line-Height</dd>
                    </dl>
                </span>
            </div>
        </section>
        <aside class="fontblock__menu col-4">
            <nav class="fontblock__nav">
                <form class="fontblock__form" action="">
                    <legend>Headline</legend>
                    <div class="form-group">
                        <textarea class="custom-textarea" name="font-primary" onchange="updateText('primary-font', this.value);" placeholder="Lorem ipsum dolor sit amet" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">Lorem ipsum dolor sit amet</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Font-family</label>
                        <select onchange="updateFont('primary-font');" class="form-control" name="primary-font-select" id="primary-font-select">
                        </select>
                    </div>
                  
                    <div class="form-group">
                        <label class="form-label" for="Font-size">Font-size</label>
                        <input onchange="setFontSize('primary-font', this.value);" on id="fontSizePrimary" class="form-control" name="primary-font-size" type="range" value="16" min="6" max="280" step="2" />
                    </div>
                   
                </form>
            </nav>
        </aside>
    </div>
    <script>
        "use strict";
       
        function updateText(el, text) {
           var target = document.getElementById(el);
           target.innerHTML = text;
        }
         // Textarea Auto Height: wir wollen keine hässliche Scrollbalken anzeigen und trotzdem die Möglichkeit haben Text mehrzeilig einzutragen
        //sautoHeight();
        function autoHeight() {
            var ct = document.getElementsByClassName('custom-textarea');
            for (var i = 0; i < ct.length; i++) {
            ct[i].setAttribute('style', 'height:' + (ct[i].scrollHeight) + 'px;');
            ct[i].addEventListener("input", onInput, false);
            }
        }
    
        function onInput() {
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
        }
        function setFontSize(targetElement, size) {
            var target = document.getElementById(targetElement);
            target.style.fontSize = size + "px";
        }
      
        // Webfonts aus externer JSON Datei auslesen
        var apiKey = "key=AIzaSyBcJ0zfjh1BYgpDtpXDmigTl-53aojQ-Wc";
        var gf = "https://www.googleapis.com/webfonts/v1/webfonts?";
        var gwf = gf+apiKey;

        var request = new XMLHttpRequest();

        request.onload = function() {
            var jsonDoc = request.responseText;
            var jsonObject = JSON.parse(jsonDoc);
            var sel = document.querySelector("#primary-font-select");
            // all items = all webfonts
            var fonts = jsonObject.items;
            
            // Erste Schleifte = alle Schriftfamilien holen
            for(var i=0; i<fonts.length; i++) {
                var families = fonts[i].family;
                var weights = fonts[i].variants;

                var optGrp = document.createElement("optgroup");
                optGrp.setAttribute("label", families);
                var opt = document.createElement("option");
               
                var t = document.createTextNode(families);
            
                // Zweite Schleife alle fontweights / Schnitte für eine Schriftfamilie holen
                for(var j=0; j<weights.length; j++) {
                    // Schriftschnitten in CSS Kompatible Werte Konvertieren z.B. "regular" = 400, light = 300
                    var weightValue, fontStyle;

                    // Italic aus den Schnitten entfernen und passende css style erzeugen
                
                    //console.log(weights);
                    opt = document.createElement("option");
                    opt.setAttribute("data-weight", weights[j]);
                    // Setze Option Name als Familie + Schnitt als String
                    t = document.createTextNode((families + ' ' + weights[j]).toString());
                    // Setze aber Option Value nur die Familie, Schnitt wird in ein separates data Attribut gespeichert
                    var s = document.createTextNode(families);
                    //w = document.createTextNode( weights[j].toString());
                    //t2 = document.createTextNode(weights[j]);
                    opt.setAttribute("value", families);
                    opt.appendChild(t);
                    optGrp.appendChild(opt);
                    //sconsole.log(t);
                }
                opt.appendChild(t);
                opt.setAttribute("value", families);
                optGrp.appendChild(opt);
                sel.appendChild(optGrp);
               // var families = jsonObject.items.family;
            }
         
           // console.log(fonts.length);
        }
        request.open("GET", gwf, true);
        request.setRequestHeader("Accept", "application/json");
        request.send();  

        // Schrift aus dem Select Aktualisieren
        function updateFont(targetElement) {
            var target = document.getElementById(targetElement);
            var selector = document.querySelector('#primary-font-select');
            var value = selector[selector.selectedIndex].value;
            var dataWeight = selector[selector.selectedIndex].getAttribute('data-weight');
            // String muss in einführungszeichen ausgegeben werden
            var valueInQuotes =  "'" + value + "'";
            // Schrift Familie setzen
            target.style.fontFamily = valueInQuotes;
            // Font-weight / Schriftschnitte setzen aus dem data-weight Attribut
            target.style.fontWeight = dataWeight;
        
        }

    </script>
    <script src="<%= htmlWebpackPlugin.files.chunks.main.entry %>"></script>

</body>

</html>